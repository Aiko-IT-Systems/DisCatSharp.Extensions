{"version":3,"names":["PRIMARY_LOCALE","FALLBACK_LOCALES","storedScheme","localStorage","getItem","vscodeScheme","navigator","userAgent","includes","REPO_BLOB_BASE","state","report","strings","locales","selected","realKeys","Set","el","id","document","getElementById","keyList","details","summary","scheme","search","filter","downloadBtn","modalHost","async","loadAll","Promise","all","fetchJson","Object","keys","missingKeys","forEach","key","prototype","hasOwnProperty","call","length","textContent","usedKeysCount","definedKeysCount","unusedKeys","dynamicKeyUsages","renderKeyList","renderDetails","query","value","toLowerCase","filterValue","expectedLocales","set","add","values","map","loc","collectExpectedLocales","translationKeys","dynamicKeys","d","keyFromDynamic","k","Array","from","sort","a","b","localeCompare","innerHTML","template","translations","valuesText","join","isReportedMissing","isDynamic","some","isMissingKey","has","isUnused","primaryMissing","trim","isMissingLocale","expected","text","hasMissingLocale","isDynamicBadge","node","content","firstElementChild","cloneNode","querySelector","badges","style","flexWrap","append","makeBadge","addEventListener","classList","className","existsInStrings","isDynamicKey","dynamicCandidates","dynamicKeyCandidates","orderLocales","wrapper","createElement","title","hint","dynNote","transWrap","locale","makeLocaleRow","addLocaleRow","addSelect","availableLocales","existing","options","l","addButton","onclick","insertBefore","actions","saveBtn","confirmModal","querySelectorAll","row","dataset","res","fetch","encodeURIComponent","method","headers","body","JSON","stringify","ok","msg","readError","alert","showToast","saveKey","deleteBtn","deleteKey","usageSection","usageList","usages","keyUsages","dynUsages","usageTemplate","repoRoot","replace","u","file","line","fullPath","ensureUsageOpen","codeUrl","encodeURI","window","open","gitBtn","gitUrl","copyText","reason","none","candidateSection","candidateList","cand","cursor","input","disabled","textarea","autosizeText","remove","height","scrollHeight","tone","span","dyn","raw","expression","expr","s","startsWith","slice","brace","indexOf","normalizeDynamicKey","btn","prepend","toastMessage","clipboard","writeText","then","message","toast","setTimeout","resolve","backdrop","modal","cancel","url","Error","json","data","status","statusText","err","String","prompt","blob","Blob","type","URL","createObjectURL","href","download","click","revokeObjectURL","setItem"],"sources":["https://translate-scwg.admin.aitsys.dev/app.ts"],"sourcesContent":["(() => {\r\n\ttype Locale = string;\r\n\ttype TranslationMap = Record<Locale, string>;\r\n\ttype StringsMap = Record<string, TranslationMap>;\r\n\r\n\ttype AuditUsage = {\r\n\t\tfile: string;\r\n\t\tline: number;\r\n\t\treason?: string;\r\n\t\texpression?: string;\r\n\t};\r\n\r\n\ttype AuditReport = {\r\n\t\tusedKeysCount: number;\r\n\t\tdefinedKeysCount: number;\r\n\t\tmissingKeys: string[];\r\n\t\tunusedKeys: string[];\r\n\t\tdynamicKeyUsages: AuditUsage[];\r\n\t\tdynamicKeyCandidates?: Record<string, string[]>;\r\n\t\tkeyUsages: Record<string, AuditUsage[]>;\r\n\t\trepoRoot: string;\r\n\t};\r\n\r\n\ttype State = {\r\n\t\treport: AuditReport | null;\r\n\t\tstrings: StringsMap;\r\n\t\tlocales: Locale[];\r\n\t\tselected: string | null;\r\n\t\trealKeys: Set<string>;\r\n\t};\r\n\r\n\tconst PRIMARY_LOCALE = \"en-US\";\r\n\tconst FALLBACK_LOCALES: Locale[] = [\r\n\t\t\"da\",\r\n\t\t\"de\",\r\n\t\t\"en-GB\",\r\n\t\t\"en-US\",\r\n\t\t\"es-ES\",\r\n\t\t\"fr\",\r\n\t\t\"hr\",\r\n\t\t\"it\",\r\n\t\t\"lt\",\r\n\t\t\"hu\",\r\n\t\t\"nl\",\r\n\t\t\"no\",\r\n\t\t\"pl\",\r\n\t\t\"pt-BR\",\r\n\t\t\"ro\",\r\n\t\t\"fi\",\r\n\t\t\"sv-SE\",\r\n\t\t\"vi\",\r\n\t\t\"tr\",\r\n\t\t\"cs\",\r\n\t\t\"el\",\r\n\t\t\"bg\",\r\n\t\t\"ru\",\r\n\t\t\"uk\",\r\n\t\t\"hi\",\r\n\t\t\"th\",\r\n\t\t\"zh-CN\",\r\n\t\t\"ja\",\r\n\t\t\"zh-TW\",\r\n\t\t\"ko\",\r\n\t];\r\n\r\n\tconst storedScheme = localStorage.getItem(\"vscodeScheme\");\r\n\tlet vscodeScheme =\r\n\t\tstoredScheme === \"vscode-insiders\" || storedScheme === \"vscode\"\r\n\t\t\t? storedScheme\r\n\t\t\t: navigator.userAgent.includes(\"Insider\")\r\n\t\t\t? \"vscode-insiders\"\r\n\t\t\t: \"vscode\";\r\n\tconst REPO_BLOB_BASE =\r\n\t\t\"https://github.com/Aiko-IT-Systems/ScWikeloGrind/blob/main\";\r\n\r\n\tconst state: State = {\r\n\t\treport: null,\r\n\t\tstrings: {},\r\n\t\tlocales: [],\r\n\t\tselected: null,\r\n\t\trealKeys: new Set<string>(),\r\n\t};\r\n\r\n\tconst el = (id: string) => document.getElementById(id)!;\r\n\tconst keyList = el(\"keyList\");\r\n\tconst details = el(\"detailsBody\");\r\n\tconst summary = el(\"summary\");\r\n\tconst scheme = el(\"scheme\") as HTMLSelectElement;\r\n\tconst search = el(\"search\") as HTMLInputElement;\r\n\tconst filter = el(\"filter\") as HTMLSelectElement;\r\n\tconst downloadBtn = el(\"downloadStrings\");\r\n\tconst modalHost = el(\"modalHost\");\r\n\r\n\tel(\"refresh\").addEventListener(\"click\", refreshAll);\r\n\tel(\"addKey\").addEventListener(\"click\", onAddKey);\r\n\tel(\"beautify\").addEventListener(\"click\", beautify);\r\n\tdownloadBtn.addEventListener(\"click\", downloadStrings);\r\n\tscheme.addEventListener(\"change\", () => {\r\n\t\tvscodeScheme = scheme.value;\r\n\t\tlocalStorage.setItem(\"vscodeScheme\", vscodeScheme);\r\n\t\trenderDetails(state.selected);\r\n\t});\r\n\r\n\tscheme.value = vscodeScheme;\r\n\tsearch.addEventListener(\"input\", renderKeyList);\r\n\tfilter.addEventListener(\"change\", renderKeyList);\r\n\r\n\tasync function loadAll() {\r\n\t\tconst [report, strings, locales] = await Promise.all([\r\n\t\t\tfetchJson<AuditReport>(\"/api/report\"),\r\n\t\t\tfetchJson<StringsMap>(\"/api/strings\"),\r\n\t\t\tfetchJson<Locale[]>(\"/api/locales\"),\r\n\t\t]);\r\n\r\n\t\tstate.report = report;\r\n\t\tstate.realKeys = new Set(Object.keys(strings));\r\n\t\tstate.strings = { ...strings };\r\n\r\n\t\tconst missingKeys = report?.missingKeys ?? [];\r\n\t\tmissingKeys.forEach((key) => {\r\n\t\t\tif (!Object.prototype.hasOwnProperty.call(state.strings, key)) {\r\n\t\t\t\tstate.strings[key] = { [PRIMARY_LOCALE]: \"\" };\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tstate.locales =\r\n\t\t\tlocales && locales.length > 0 ? locales : FALLBACK_LOCALES;\r\n\t\tsummary.textContent = `Used ${report.usedKeysCount} / Defined ${report.definedKeysCount} | Missing ${report.missingKeys.length} | Unused ${report.unusedKeys.length} | Dynamic ${report.dynamicKeyUsages.length}`;\r\n\t\trenderKeyList();\r\n\t\trenderDetails(state.selected);\r\n\t}\r\n\r\n\tfunction renderKeyList() {\r\n\t\tif (!state.report) return;\r\n\t\tconst query = search.value.toLowerCase();\r\n\t\tconst filterValue = filter.value;\r\n\t\tconst expectedLocales = collectExpectedLocales(state.strings);\r\n\r\n\t\tconst translationKeys = Object.keys(state.strings);\r\n\t\tconst missingKeys = state.report?.missingKeys ?? [];\r\n\t\tconst dynamicKeys = (state.report.dynamicKeyUsages || [])\r\n\t\t\t.map((d) => keyFromDynamic(d))\r\n\t\t\t.filter((k) => k && k.includes(\".\"));\r\n\t\tconst keys = Array.from(\r\n\t\t\tnew Set([...translationKeys, ...dynamicKeys, ...missingKeys])\r\n\t\t).sort((a, b) => a.localeCompare(b));\r\n\r\n\t\tkeyList.innerHTML = \"\";\r\n\t\tconst template = document.getElementById(\r\n\t\t\t\"key-item-template\"\r\n\t\t) as HTMLTemplateElement;\r\n\r\n\t\tkeys.forEach((key) => {\r\n\t\t\tconst translations = state.strings[key] || {};\r\n\t\t\tconst valuesText = Object.values(translations)\r\n\t\t\t\t.join(\" \")\r\n\t\t\t\t.toLowerCase();\r\n\t\t\tif (\r\n\t\t\t\tquery &&\r\n\t\t\t\t!key.toLowerCase().includes(query) &&\r\n\t\t\t\t!valuesText.includes(query)\r\n\t\t\t)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tconst isReportedMissing = missingKeys.includes(key);\r\n\t\t\tconst isDynamic = state.report!.dynamicKeyUsages.some(\r\n\t\t\t\t(d) => keyFromDynamic(d) === key\r\n\t\t\t);\r\n\t\t\tconst isMissingKey = !isDynamic && (!state.realKeys.has(key) || isReportedMissing);\r\n\t\t\tconst isUnused = state.report!.unusedKeys.includes(key);\r\n\t\t\tconst primaryMissing =\r\n\t\t\t\t!translations[PRIMARY_LOCALE] ||\r\n\t\t\t\ttranslations[PRIMARY_LOCALE].trim().length === 0;\r\n\t\t\tconst isMissingLocale =\r\n\t\t\t\t!isMissingKey &&\r\n\t\t\t\t!isDynamic &&\r\n\t\t\t\t(primaryMissing || hasMissingLocale(translations, expectedLocales));\r\n\t\t\tconst isDynamicBadge = isDynamic;\r\n\r\n\t\t\tif (filterValue === \"kmissing\" && !isMissingKey) return;\r\n\t\t\tif (filterValue === \"lmissing\" && !isMissingLocale) return;\r\n\t\t\tif (filterValue === \"unused\" && !isUnused) return;\r\n\t\t\tif (filterValue === \"dynamic\" && !isDynamicBadge) return;\r\n\r\n\t\t\tconst node = template.content.firstElementChild!.cloneNode(\r\n\t\t\t\ttrue\r\n\t\t\t) as HTMLElement;\r\n\t\t\tnode.querySelector<HTMLElement>(\".key-text\")!.textContent = key;\r\n\t\t\tconst badges = node.querySelector<HTMLElement>(\".badges\")!;\r\n\t\t\tbadges.style.flexWrap = \"wrap\";\r\n\t\t\tif (isMissingKey) badges.append(makeBadge(\"Missing Key\", \"danger\"));\r\n\t\t\tif (isUnused) badges.append(makeBadge(\"Unused\", \"warn\"));\r\n\t\t\tif (!isMissingKey && isMissingLocale)\r\n\t\t\t\tbadges.append(makeBadge(\"Missing Locale\", \"danger\"));\r\n\t\t\tif (isDynamicBadge) badges.append(makeBadge(\"Dynamic\", \"success\"));\r\n\t\t\tnode.addEventListener(\"click\", () => renderDetails(key));\r\n\t\t\tif (state.selected === key) node.classList.add(\"selected\");\r\n\t\t\tkeyList.append(node);\r\n\t\t});\r\n\t}\r\n\r\n\tfunction collectExpectedLocales(strings: StringsMap) {\r\n\t\tconst set = new Set<Locale>();\r\n\t\tset.add(PRIMARY_LOCALE);\r\n\t\tObject.values(strings).forEach((map) => {\r\n\t\t\tObject.keys(map || {}).forEach((loc) => set.add(loc));\r\n\t\t});\r\n\t\treturn set;\r\n\t}\r\n\r\n\tfunction hasMissingLocale(translations: TranslationMap, expected: Set<Locale>) {\r\n\t\tfor (const loc of expected) {\r\n\t\t\tconst text = translations?.[loc] ?? \"\";\r\n\t\t\tif (!text || text.trim().length === 0) return true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction renderDetails(key: string | null) {\r\n\t\tstate.selected = key;\r\n\t\tif (!key) {\r\n\t\t\tdetails.className = \"details-empty\";\r\n\t\t\tdetails.textContent = \"Select a key to edit\";\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst existsInStrings = state.realKeys.has(key);\r\n\t\tconst isDynamicKey = state.report?.dynamicKeyUsages.some(\r\n\t\t\t(d) => keyFromDynamic(d) === key\r\n\t\t);\r\n\t\tconst dynamicCandidates = state.report?.dynamicKeyCandidates?.[key] ?? [];\r\n\t\tconst translations = state.strings[key] || { [PRIMARY_LOCALE]: \"\" };\r\n\t\tconst locales = orderLocales(Object.keys(translations));\r\n\r\n\t\tconst wrapper = document.createElement(\"div\");\r\n\t\twrapper.className = \"details\";\r\n\t\tconst title = document.createElement(\"div\");\r\n\t\ttitle.innerHTML = `<strong>${key}</strong>${\r\n\t\t\texistsInStrings || isDynamicKey\r\n\t\t\t\t? \"\"\r\n\t\t\t\t: ' <span class=\"badge warn\">Missing Key</span>'\r\n\t\t}`;\r\n\t\twrapper.append(title);\r\n\t\tif (!existsInStrings && !isDynamicKey) {\r\n\t\t\tconst hint = document.createElement(\"div\");\r\n\t\t\thint.className = \"details-empty\";\r\n\t\t\thint.textContent =\r\n\t\t\t\t\"This key is missing from strings.json. Fill in values and Save to create it.\";\r\n\t\t\twrapper.append(hint);\r\n\t\t}\r\n\r\n\t\tif (isDynamicKey) {\r\n\t\t\tconst dynNote = document.createElement(\"div\");\r\n\t\t\tdynNote.className = \"details-empty\";\r\n\t\t\tdynNote.textContent = \"Dynamic key: manage concrete keys instead.\";\r\n\t\t\twrapper.append(dynNote);\r\n\t\t} else {\r\n\t\t\tconst transWrap = document.createElement(\"div\");\r\n\t\t\ttransWrap.className = \"translations\";\r\n\t\t\tlocales.forEach((locale) => {\r\n\t\t\t\ttransWrap.append(makeLocaleRow(locale, translations[locale] ?? \"\"));\r\n\t\t\t});\r\n\r\n\t\t\tconst addLocaleRow = document.createElement(\"div\");\r\n\t\t\taddLocaleRow.className = \"translation-add-row\";\r\n\t\t\tconst addSelect = document.createElement(\"select\");\r\n\t\t\tconst availableLocales = orderLocales(state.locales);\r\n\t\t\tconst existing = new Set(locales);\r\n\t\t\tconst options = availableLocales.filter((l) => !existing.has(l));\r\n\t\t\taddSelect.innerHTML = `<option value=\"\">Select locale</option>${options\r\n\t\t\t\t.map((l) => `<option value=\"${l}\">${l}</option>`)\r\n\t\t\t\t.join(\"\")}`;\r\n\t\t\tconst addButton = document.createElement(\"button\");\r\n\t\t\taddButton.textContent = \"Add locale\";\r\n\t\t\taddButton.className = \"secondary\";\r\n\t\t\taddButton.onclick = () => {\r\n\t\t\t\tconst loc = addSelect.value;\r\n\t\t\t\tif (!loc) return;\r\n\t\t\t\tif (transWrap.querySelector(`[data-locale=\"${loc}\"]`)) return;\r\n\t\t\t\ttransWrap.insertBefore(makeLocaleRow(loc, \"\"), addLocaleRow);\r\n\t\t\t\taddSelect.value = \"\";\r\n\t\t\t};\r\n\t\t\tconst actions = document.createElement(\"div\");\r\n\t\t\tactions.className = \"footer-actions\";\r\n\t\t\tconst saveBtn = document.createElement(\"button\");\r\n\t\t\tsaveBtn.textContent = \"Save\";\r\n\t\t\tsaveBtn.classList.add(\"success\");\r\n\t\t\tsaveBtn.onclick = () => saveKey(key, transWrap);\r\n\t\t\tconst deleteBtn = document.createElement(\"button\");\r\n\t\t\tdeleteBtn.textContent = \"Delete\";\r\n\t\t\tdeleteBtn.className = \"danger\";\r\n\t\t\tdeleteBtn.onclick = () => deleteKey(key);\r\n\t\t\tactions.append(saveBtn, deleteBtn);\r\n\t\t\taddLocaleRow.append(addSelect, addButton, actions);\r\n\t\t\ttransWrap.append(addLocaleRow);\r\n\t\t\twrapper.append(transWrap);\r\n\t\t}\r\n\r\n\t\tconst usageSection = document.createElement(\"div\");\r\n\t\tusageSection.className = \"usage\";\r\n\t\tusageSection.innerHTML = \"<strong>Usages</strong>\";\r\n\t\tconst usageList = document.createElement(\"div\");\r\n\t\tconst usages = state.report?.keyUsages[key] || [];\r\n\t\tconst dynUsages = (state.report?.dynamicKeyUsages || []).filter(\r\n\t\t\t(d) => keyFromDynamic(d) === key\r\n\t\t);\r\n\t\tconst usageTemplate = document.getElementById(\r\n\t\t\t\"usage-row-template\"\r\n\t\t) as HTMLTemplateElement;\r\n\t\tconst repoRoot = (state.report?.repoRoot || \"\").replace(/\\\\/g, \"/\");\r\n\t\tif (usages.length > 0) {\r\n\t\t\tusages.forEach((u) => {\r\n\t\t\t\tconst row = usageTemplate.content.firstElementChild!.cloneNode(\r\n\t\t\t\t\ttrue\r\n\t\t\t\t) as HTMLElement;\r\n\t\t\t\trow.querySelector<HTMLElement>(\r\n\t\t\t\t\t\".usage-file\"\r\n\t\t\t\t)!.textContent = `${u.file} : ${u.line}`;\r\n\t\t\t\tconst fullPath = `${repoRoot}/${u.file}`.replace(/\\\\/g, \"/\");\r\n\t\t\t\tconst openBtn = ensureUsageOpen(row);\r\n\t\t\t\topenBtn.onclick = () => {\r\n\t\t\t\t\tconst codeUrl = `${vscodeScheme}://file/${encodeURI(\r\n\t\t\t\t\t\tfullPath\r\n\t\t\t\t\t)}:${u.line}`;\r\n\t\t\t\t\twindow.open(codeUrl, \"_blank\");\r\n\t\t\t\t};\r\n\t\t\t\tconst gitBtn =\r\n\t\t\t\t\trow.querySelector<HTMLButtonElement>(\".usage-copy\")!;\r\n\t\t\t\tconst gitUrl = `${REPO_BLOB_BASE}/${u.file.replace(\r\n\t\t\t\t\t/\\\\/g,\r\n\t\t\t\t\t\"/\"\r\n\t\t\t\t)}#L${u.line}`;\r\n\t\t\t\tgitBtn.onclick = () => copyText(gitUrl, \"Git link copied\");\r\n\t\t\t\tusageList.append(row);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (dynUsages.length > 0) {\r\n\t\t\tdynUsages.forEach((d) => {\r\n\t\t\t\tconst row = usageTemplate.content.firstElementChild!.cloneNode(\r\n\t\t\t\t\ttrue\r\n\t\t\t\t) as HTMLElement;\r\n\t\t\t\trow.querySelector<HTMLElement>(\".usage-file\")!.textContent = `${\r\n\t\t\t\t\td.file\r\n\t\t\t\t} : ${d.line} (dynamic: ${d.reason ?? \"\"})`;\r\n\t\t\t\tconst fullPath = `${repoRoot}/${d.file}`.replace(/\\\\/g, \"/\");\r\n\t\t\t\tconst openBtn = ensureUsageOpen(row);\r\n\t\t\t\topenBtn.onclick = () => {\r\n\t\t\t\t\tconst codeUrl = `${vscodeScheme}://file/${encodeURI(\r\n\t\t\t\t\t\tfullPath\r\n\t\t\t\t\t)}:${d.line}`;\r\n\t\t\t\t\twindow.open(codeUrl, \"_blank\");\r\n\t\t\t\t};\r\n\t\t\t\tconst gitBtn =\r\n\t\t\t\t\trow.querySelector<HTMLButtonElement>(\".usage-copy\")!;\r\n\t\t\t\tconst gitUrl = `${REPO_BLOB_BASE}/${d.file.replace(\r\n\t\t\t\t\t/\\\\/g,\r\n\t\t\t\t\t\"/\"\r\n\t\t\t\t)}#L${d.line}`;\r\n\t\t\t\tgitBtn.onclick = () => copyText(gitUrl, \"Git link copied\");\r\n\t\t\t\tusageList.append(row);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (usages.length === 0 && dynUsages.length === 0) {\r\n\t\t\tconst none = document.createElement(\"div\");\r\n\t\t\tnone.textContent = \"No usages found.\";\r\n\t\t\tnone.className = \"details-empty\";\r\n\t\t\tusageList.append(none);\r\n\t\t}\r\n\t\tusageSection.append(usageList);\r\n\t\twrapper.append(usageSection);\r\n\r\n\t\tif (isDynamicKey && dynamicCandidates.length > 0) {\r\n\t\t\tconst candidateSection = document.createElement(\"div\");\r\n\t\t\tcandidateSection.className = \"usage\";\r\n\t\t\tcandidateSection.innerHTML = \"<strong>Candidate keys</strong>\";\r\n\t\t\tconst candidateList = document.createElement(\"div\");\r\n\t\t\tcandidateList.className = \"candidate-list\";\r\n\t\t\tdynamicCandidates.forEach((cand) => {\r\n\t\t\t\tconst row = document.createElement(\"div\");\r\n\t\t\t\trow.className = \"details-empty\";\r\n\t\t\t\trow.textContent = cand;\r\n\t\t\t\trow.style.cursor = \"pointer\";\r\n\t\t\t\trow.onclick = () => renderDetails(cand);\r\n\t\t\t\tcandidateList.append(row);\r\n\t\t\t});\r\n\t\t\tcandidateSection.append(candidateList);\r\n\t\t\twrapper.append(candidateSection);\r\n\t\t}\r\n\r\n\t\tdetails.className = \"\";\r\n\t\tdetails.innerHTML = \"\";\r\n\t\tdetails.append(wrapper);\r\n\t}\r\n\r\n\tfunction makeLocaleRow(locale: string, value: string) {\r\n\t\tconst row = document.createElement(\"div\");\r\n\t\trow.className = \"translation-row\";\r\n\t\trow.dataset.locale = locale;\r\n\t\tconst input = document.createElement(\"input\");\r\n\t\tinput.value = locale;\r\n\t\tinput.disabled = true;\r\n\t\tconst textarea = document.createElement(\"textarea\");\r\n\t\ttextarea.value = value ?? \"\";\r\n\t\tautosizeText(textarea);\r\n\t\ttextarea.addEventListener(\"input\", () => autosizeText(textarea));\r\n\t\tconst remove = document.createElement(\"button\");\r\n\t\tremove.textContent = \"Remove\";\r\n\t\tremove.className = \"danger\";\r\n\t\tremove.onclick = () => {\r\n\t\t\tif (locale === PRIMARY_LOCALE) return;\r\n\t\t\trow.remove();\r\n\t\t};\r\n\t\tif (locale === PRIMARY_LOCALE) {\r\n\t\t\tremove.disabled = true;\r\n\t\t\tremove.textContent = \"Primary\";\r\n\t\t}\r\n\t\trow.append(input, textarea, remove);\r\n\t\treturn row;\r\n\t}\r\n\r\n\tfunction autosizeText(textarea: HTMLTextAreaElement) {\r\n\t\ttextarea.style.height = \"auto\";\r\n\t\ttextarea.style.height = `${textarea.scrollHeight}px`;\r\n\t}\r\n\r\n\tfunction orderLocales(locales: string[]) {\r\n\t\treturn [...locales].sort((a, b) => {\r\n\t\t\tif (a === b) return 0;\r\n\t\t\tif (a === PRIMARY_LOCALE) return -1;\r\n\t\t\tif (b === PRIMARY_LOCALE) return 1;\r\n\t\t\treturn a.localeCompare(b);\r\n\t\t});\r\n\t}\r\n\r\n\tasync function saveKey(key: string, transWrap: HTMLElement) {\r\n\t\tconst ok = await confirmModal(\r\n\t\t\t\"Save changes?\",\r\n\t\t\t\"This will write updates to strings.json.\"\r\n\t\t);\r\n\t\tif (!ok) return;\r\n\t\tconst translations: TranslationMap = {};\r\n\t\ttransWrap\r\n\t\t\t.querySelectorAll<HTMLElement>(\".translation-row\")\r\n\t\t\t.forEach((row) => {\r\n\t\t\t\tconst loc = row.dataset.locale;\r\n\t\t\t\tconst text = (\r\n\t\t\t\t\trow.querySelector(\"textarea\") as HTMLTextAreaElement\r\n\t\t\t\t).value;\r\n\t\t\t\tif (loc) translations[loc] = text;\r\n\t\t\t});\r\n\t\tconst res = await fetch(`/api/strings/${encodeURIComponent(key)}`, {\r\n\t\t\tmethod: \"PUT\",\r\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\tbody: JSON.stringify({ key, translations }),\r\n\t\t});\r\n\t\tif (!res.ok) {\r\n\t\t\tconst msg = await readError(res);\r\n\t\t\talert(`Save failed: ${msg}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tawait loadAll();\r\n\t\trenderDetails(key);\r\n\t\tshowToast(\"Saved\");\r\n\t}\r\n\r\n\tasync function deleteKey(key: string) {\r\n\t\tconst ok = await confirmModal(\r\n\t\t\t\"Delete key?\",\r\n\t\t\t`This removes '${key}' from strings.json.`\r\n\t\t);\r\n\t\tif (!ok) return;\r\n\t\tconst res = await fetch(`/api/strings/${encodeURIComponent(key)}`, {\r\n\t\t\tmethod: \"DELETE\",\r\n\t\t});\r\n\t\tif (!res.ok) {\r\n\t\t\tconst msg = await readError(res);\r\n\t\t\talert(`Delete failed: ${msg}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tawait loadAll();\r\n\t\trenderDetails(null);\r\n\t\tshowToast(\"Deleted\");\r\n\t}\r\n\r\n\tasync function onAddKey() {\r\n\t\tconst key = prompt(\"New translation key\");\r\n\t\tif (!key) return;\r\n\t\tconst res = await fetch(\"/api/strings\", {\r\n\t\t\tmethod: \"POST\",\r\n\t\t\theaders: { \"Content-Type\": \"application/json\" },\r\n\t\t\tbody: JSON.stringify({\r\n\t\t\t\tkey,\r\n\t\t\t\ttranslations: { [PRIMARY_LOCALE]: \"\" },\r\n\t\t\t}),\r\n\t\t});\r\n\t\tif (!res.ok) {\r\n\t\t\tconst msg = await readError(res);\r\n\t\t\talert(`Add failed: ${msg}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tawait loadAll();\r\n\t\trenderDetails(key);\r\n\t}\r\n\r\n\tasync function beautify() {\r\n\t\tconst ok = await confirmModal(\r\n\t\t\t\"Beautify strings.json?\",\r\n\t\t\t\"This will rewrite strings.json with formatting.\"\r\n\t\t);\r\n\t\tif (!ok) return;\r\n\t\tconst res = await fetch(\"/api/strings/format\", { method: \"POST\" });\r\n\t\tif (!res.ok) {\r\n\t\t\tconst msg = await readError(res);\r\n\t\t\talert(`Beautify failed: ${msg}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tawait loadAll();\r\n\t\tshowToast(\"Formatted\");\r\n\t}\r\n\r\n\tfunction makeBadge(text: string, tone: \"warn\" | \"danger\" | \"success\") {\r\n\t\tconst span = document.createElement(\"span\");\r\n\t\tspan.className = `badge ${tone}`;\r\n\t\tspan.textContent = text;\r\n\t\treturn span;\r\n\t}\r\n\r\n\tfunction keyFromDynamic(dyn: AuditUsage | null | undefined) {\r\n\t\tif (!dyn) return \"\";\r\n\t\tconst raw = dyn.expression || \"\";\r\n\t\tconst normalized = normalizeDynamicKey(raw);\r\n\t\treturn normalized || raw || \"\";\r\n\t}\r\n\r\n\tfunction normalizeDynamicKey(expr: string) {\r\n\t\tlet s = expr.trim();\r\n\t\tif (s.startsWith(\"@$\")) s = s.slice(2);\r\n\t\telse if (s.startsWith(\"$\")) s = s.slice(1);\r\n\t\ts = s.replace(/^\"/, \"\").replace(/\"$/, \"\");\r\n\t\tconst brace = s.indexOf(\"{\");\r\n\t\tif (brace >= 0) s = s.slice(0, brace);\r\n\t\treturn s.trim();\r\n\t}\r\n\r\n\tfunction ensureUsageOpen(row: HTMLElement) {\r\n\t\tlet btn = row.querySelector<HTMLButtonElement>(\".usage-open\");\r\n\t\tif (!btn) {\r\n\t\t\tbtn = document.createElement(\"button\");\r\n\t\t\tbtn.className = \"usage-open\";\r\n\t\t\tbtn.textContent = \"Open in VS Code\";\r\n\t\t\tconst actions =\r\n\t\t\t\trow.querySelector<HTMLElement>(\".usage-actions\") || row;\r\n\t\t\tactions.prepend(btn);\r\n\t\t}\r\n\t\treturn btn;\r\n\t}\r\n\r\n\tasync function refreshAll() {\r\n\t\ttry {\r\n\t\t\tawait loadAll();\r\n\t\t\tshowToast(\"Refreshed\");\r\n\t\t} catch (err: unknown) {\r\n\t\t\tconst message = (err as Error)?.message || String(err);\r\n\t\t\talert(`Refresh failed: ${message}`);\r\n\t\t}\r\n\t}\r\n\r\n\tasync function downloadStrings() {\r\n\t\ttry {\r\n\t\t\tconst res = await fetch(\"/api/strings\");\r\n\t\t\tif (!res.ok) throw new Error(await readError(res));\r\n\t\t\tconst data = await res.json();\r\n\t\t\tconst blob = new Blob([JSON.stringify(data, null, 2)], {\r\n\t\t\t\ttype: \"application/json\",\r\n\t\t\t});\r\n\t\t\tconst url = URL.createObjectURL(blob);\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = \"strings.json\";\r\n\t\t\ta.click();\r\n\t\t\tURL.revokeObjectURL(url);\r\n\t\t\tshowToast(\"Downloaded strings.json\");\r\n\t\t} catch (err: unknown) {\r\n\t\t\talert(`Download failed: ${err}`);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction copyText(text: string, toastMessage: string) {\r\n\t\tnavigator.clipboard\r\n\t\t\t?.writeText(text)\r\n\t\t\t.then(() => showToast(toastMessage));\r\n\t}\r\n\r\n\tfunction showToast(message: string) {\r\n\t\tconst toast = document.createElement(\"div\");\r\n\t\ttoast.className = \"toast\";\r\n\t\ttoast.textContent = message;\r\n\t\tdocument.body.append(toast);\r\n\t\tsetTimeout(() => toast.remove(), 2000);\r\n\t}\r\n\r\n\tfunction confirmModal(title: string, message: string) {\r\n\t\treturn new Promise<boolean>((resolve) => {\r\n\t\t\tconst backdrop = document.createElement(\"div\");\r\n\t\t\tbackdrop.className = \"modal-backdrop\";\r\n\t\t\tconst modal = document.createElement(\"div\");\r\n\t\t\tmodal.className = \"modal\";\r\n\t\t\tmodal.innerHTML = `<h3>${title}</h3><p>${message}</p>`;\r\n\t\t\tconst actions = document.createElement(\"div\");\r\n\t\t\tactions.className = \"modal-actions\";\r\n\t\t\tconst cancel = document.createElement(\"button\");\r\n\t\t\tcancel.className = \"ghost\";\r\n\t\t\tcancel.textContent = \"Cancel\";\r\n\t\t\tconst ok = document.createElement(\"button\");\r\n\t\t\tok.className = \"danger\";\r\n\t\t\tok.textContent = \"Confirm\";\r\n\t\t\tcancel.onclick = () => {\r\n\t\t\t\tbackdrop.remove();\r\n\t\t\t\tresolve(false);\r\n\t\t\t};\r\n\t\t\tok.onclick = () => {\r\n\t\t\t\tbackdrop.remove();\r\n\t\t\t\tresolve(true);\r\n\t\t\t};\r\n\t\t\tactions.append(cancel, ok);\r\n\t\t\tmodal.append(actions);\r\n\t\t\tbackdrop.append(modal);\r\n\t\t\tmodalHost.append(backdrop);\r\n\t\t});\r\n\t}\r\n\r\n\tasync function fetchJson<T>(url: string) {\r\n\t\tconst res = await fetch(url);\r\n\t\tif (!res.ok) {\r\n\t\t\tconst msg = await readError(res);\r\n\t\t\tthrow new Error(msg);\r\n\t\t}\r\n\t\treturn res.json() as Promise<T>;\r\n\t}\r\n\r\n\tasync function readError(res: Response) {\r\n\t\ttry {\r\n\t\t\tconst data = await res.json();\r\n\t\t\tif ((data as { message?: string })?.message)\r\n\t\t\t\treturn (data as { message: string }).message;\r\n\t\t\treturn `${res.status} ${res.statusText}`;\r\n\t\t} catch {\r\n\t\t\treturn `${res.status} ${res.statusText}`;\r\n\t\t}\r\n\t}\r\n\r\n\tloadAll();\r\n})();\r\n"],"mappings":"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","ignoreList":[]}